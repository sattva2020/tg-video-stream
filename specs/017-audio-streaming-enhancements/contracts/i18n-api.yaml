# i18n API Contract

openapi: 3.0.3
info:
  title: Internationalization (i18n) API
  description: API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
  version: 1.0.0

paths:
  /api/v1/i18n/locales:
    get:
      summary: –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —è–∑—ã–∫–æ–≤
      operationId: getAvailableLocales
      tags:
        - i18n
      responses:
        '200':
          description: –°–ø–∏—Å–æ–∫ —è–∑—ã–∫–æ–≤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocalesListResponse'

  /api/v1/i18n/locale/{locale}:
    get:
      summary: –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è —è–∑—ã–∫–∞
      operationId: getLocaleTranslations
      tags:
        - i18n
      parameters:
        - name: locale
          in: path
          required: true
          schema:
            type: string
            enum: [ru, en, uk, es]
        - name: namespace
          in: query
          schema:
            type: string
          description: –§–∏–ª—å—Ç—Ä –ø–æ namespace (common, player, settings)
      responses:
        '200':
          description: –ü–µ—Ä–µ–≤–æ–¥—ã
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslationsResponse'
        '404':
          description: –Ø–∑—ã–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω

  /api/v1/user/language:
    get:
      summary: –ü–æ–ª—É—á–∏—Ç—å —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      operationId: getUserLanguage
      tags:
        - i18n
      responses:
        '200':
          description: –¢–µ–∫—É—â–∏–π —è–∑—ã–∫
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLanguageResponse'

    put:
      summary: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      operationId: setUserLanguage
      tags:
        - i18n
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetLanguageRequest'
      responses:
        '200':
          description: –Ø–∑—ã–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserLanguageResponse'
        '400':
          description: –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —è–∑—ã–∫

components:
  schemas:
    LocalesListResponse:
      type: object
      properties:
        locales:
          type: array
          items:
            $ref: '#/components/schemas/LocaleInfo'
        default:
          type: string
          example: "en"

    LocaleInfo:
      type: object
      properties:
        code:
          type: string
          example: "ru"
        name:
          type: string
          example: "–†—É—Å—Å–∫–∏–π"
        native_name:
          type: string
          example: "–†—É—Å—Å–∫–∏–π"
        flag:
          type: string
          example: "üá∑üá∫"
        direction:
          type: string
          enum: [ltr, rtl]
          example: "ltr"
        coverage:
          type: number
          format: float
          minimum: 0
          maximum: 100
          example: 100
          description: –ü—Ä–æ—Ü–µ–Ω—Ç –ø–µ—Ä–µ–≤–µ–¥—ë–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫

    TranslationsResponse:
      type: object
      properties:
        locale:
          type: string
          example: "ru"
        translations:
          type: object
          additionalProperties:
            type: object
          description: –í–ª–æ–∂–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏
          example:
            common:
              loading: "–ó–∞–≥—Ä—É–∑–∫–∞..."
              error: "–û—à–∏–±–∫–∞"
            player:
              play: "–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏"
              pause: "–ü–∞—É–∑–∞"
              speed: "–°–∫–æ—Ä–æ—Å—Ç—å"

    UserLanguageResponse:
      type: object
      properties:
        language:
          type: string
          example: "ru"
        detected_from:
          type: string
          enum: [user_preference, browser, default]
          example: "user_preference"

    SetLanguageRequest:
      type: object
      required:
        - language
      properties:
        language:
          type: string
          enum: [ru, en, uk, es]
          example: "uk"

# Frontend i18n Structure
x-frontend-structure:
  library: react-i18next
  config:
    fallbackLng: en
    supportedLngs: [ru, en, uk, es]
    detection:
      order: [localStorage, navigator]
    interpolation:
      escapeValue: false
  
  files:
    - path: frontend/src/i18n/locales/ru.json
      description: –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ (–æ—Å–Ω–æ–≤–Ω–æ–π)
    - path: frontend/src/i18n/locales/en.json
      description: English (fallback)
    - path: frontend/src/i18n/locales/uk.json
      description: –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
    - path: frontend/src/i18n/locales/es.json
      description: Espa√±ol

# Translation Keys Structure
x-translation-keys:
  namespaces:
    - name: common
      keys:
        - loading
        - error
        - success
        - cancel
        - save
        - delete
        - confirm
    
    - name: player
      keys:
        - play
        - pause
        - stop
        - next
        - previous
        - speed
        - seek_forward
        - seek_backward
        - volume
        - mute
        - unmute
        - shuffle
        - repeat
    
    - name: equalizer
      keys:
        - preset_flat
        - preset_rock
        - preset_jazz
        - preset_classical
        - preset_voice
        - preset_bass_boost
        - reset
    
    - name: radio
      keys:
        - add_station
        - playing_now
        - buffering
        - connection_lost
        - reconnecting
    
    - name: lyrics
      keys:
        - show_lyrics
        - hide_lyrics
        - not_found
        - loading_lyrics
    
    - name: settings
      keys:
        - language
        - theme
        - notifications
        - playback_settings
