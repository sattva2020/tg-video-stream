# Audio Streaming Enhancements

**Feature**: 017-audio-streaming-enhancements  
**Priority**: P1-P3  
**Ð’ÐµÑ€ÑÐ¸Ñ**: 1.0.0  
**Ð”Ð°Ñ‚Ð°**: 2024-12-02

## ÐžÐ±Ð·Ð¾Ñ€

Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Ð°ÑƒÐ´Ð¸Ð¾-ÑÑ‚Ñ€Ð¸Ð¼Ð¸Ð½Ð³Ð° Ð´Ð»Ñ Telegram Video Stream, Ð²ÐºÐ»ÑŽÑ‡Ð°ÑŽÑ‰Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ DJ-Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð¾Ð¿Ñ‹Ñ‚ Ð¸ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÐ¼Ð¾Ðµ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼Ð¸ ÐºÐ°Ð½Ð°Ð»Ð°Ð¼Ð¸.

## Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

### 1. Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ð¸ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ (P1)

**User Story**: DJ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¸Ð·Ð¼ÐµÐ½ÑÑ‚ÑŒ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ (0.5x-2.0x) Ð¸ Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ Ñ‚Ð¾Ð½Ð° Ð´Ð»Ñ Ð¼Ð¸ÐºÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:**
- Ð ÐµÐ³ÑƒÐ»Ð¸Ñ€Ð¾Ð²ÐºÐ° ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ 0.5x Ð´Ð¾ 2.0x
- Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Â±12 Ð¿Ð¾Ð»ÑƒÑ‚Ð¾Ð½Ð¾Ð²
- Pitch correction Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ñ‚ÐµÐ¼Ð±Ñ€Ð° Ð³Ð¾Ð»Ð¾ÑÐ°
- GStreamer scaletempo Ð´Ð»Ñ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ‚Ð°Ð¹Ð¼ÑÑ‚Ñ€ÐµÑ‚Ñ‡Ð°

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/speed 1.5       # Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ 1.5x
/speed           # ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ
/pitch +2        # ÐŸÐ¾Ð´Ð½ÑÑ‚ÑŒ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð½Ð° 2 Ð¿Ð¾Ð»ÑƒÑ‚Ð¾Ð½Ð°
/pitch -3        # ÐžÐ¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð½Ð° 3 Ð¿Ð¾Ð»ÑƒÑ‚Ð¾Ð½Ð°
/pitch           # ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ
```

**Web UI:**
- Ð¡Ð»Ð°Ð¹Ð´ÐµÑ€ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸ Ñ Ð¿Ñ€ÐµÑÐµÑ‚Ð°Ð¼Ð¸ (0.5x, 0.75x, 1.0x, 1.25x, 1.5x, 2.0x)
- Ð ÐµÐ³ÑƒÐ»ÑÑ‚Ð¾Ñ€ Ñ‚Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ñ Ð²Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ†Ð¸ÐµÐ¹
- ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ pitch correction

---

### 2. ÐŸÐµÑ€ÐµÐ¼Ð¾Ñ‚ÐºÐ° (P1)

**User Story**: Ð¡Ð»ÑƒÑˆÐ°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿ÐµÑ€ÐµÐ¼Ð¾Ñ‚Ð°Ñ‚ÑŒ Ñ‚Ñ€ÐµÐº Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¸Ð»Ð¸ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ.

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:**
- Seek Ðº Ð°Ð±ÑÐ¾Ð»ÑŽÑ‚Ð½Ð¾Ð¹ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸
- Relative forward/rewind (Â±30 ÑÐµÐº Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ)
- ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ-Ð±Ð°Ñ€ Ñ drag-and-drop
- ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/seek 1:30       # ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ðº 1:30
/seek 90         # ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ðº 90 ÑÐµÐºÑƒÐ½Ð´Ð°Ð¼
/forward 30      # Ð’Ð¿ÐµÑ€Ñ‘Ð´ Ð½Ð° 30 ÑÐµÐºÑƒÐ½Ð´
/rewind 15       # ÐÐ°Ð·Ð°Ð´ Ð½Ð° 15 ÑÐµÐºÑƒÐ½Ð´
/position        # ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ
```

**Web UI:**
- Ð˜Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ seek bar
- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Â±10/30 ÑÐµÐºÑƒÐ½Ð´
- ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ (current / total)

---

### 3. Ð Ð°Ð´Ð¸Ð¾-Ð¿Ð¾Ñ‚Ð¾ÐºÐ¸ (P1)

**User Story**: ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð¼Ð¾Ð¶ÐµÑ‚ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ Ð¸ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚-Ñ€Ð°Ð´Ð¸Ð¾ÑÑ‚Ð°Ð½Ñ†Ð¸Ð¸.

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:**
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° HTTP/HTTPS ÑÑ‚Ñ€Ð¸Ð¼Ð¾Ð² (MP3, AAC, OGG)
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¿ÐµÑ€ÐµÐ¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸ Ñ€Ð°Ð·Ñ€Ñ‹Ð²Ðµ
- ÐœÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ðµ ICY (title, artist)
- Ð‘ÑƒÑ„ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/addradio https://stream.example.com/radio.mp3 "My Radio"
/radio "My Radio"     # ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ
/radiolist            # Ð¡Ð¿Ð¸ÑÐ¾Ðº ÑÑ‚Ð°Ð½Ñ†Ð¸Ð¹
/radiostop            # ÐžÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ñ€Ð°Ð´Ð¸Ð¾
```

**Web UI:**
- Ð¡Ð¿Ð¸ÑÐ¾Ðº ÑÑ‚Ð°Ð½Ñ†Ð¸Ð¹ Ñ Ð¿Ð¾Ð¸ÑÐºÐ¾Ð¼
- Ð˜Ð·Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ ÑÑ‚Ð°Ð½Ñ†Ð¸Ð¸
- Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ "Live"
- Ð’Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑƒÑ€Ð¾Ð²Ð½Ñ ÑÐ¸Ð³Ð½Ð°Ð»Ð°

---

### 4. Rate Limiting (P1)

**User Story**: Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð·Ð°Ñ‰Ð¸Ñ‰ÐµÐ½Ð° Ð¾Ñ‚ Ð·Ð»Ð¾ÑƒÐ¿Ð¾Ñ‚Ñ€ÐµÐ±Ð»ÐµÐ½Ð¸Ð¹ Ñ Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ð¼Ð¸ Ð»Ð¸Ð¼Ð¸Ñ‚Ð°Ð¼Ð¸.

**Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ:**
- Fixed Window Counter Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼
- Redis Ð´Ð»Ñ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ð¾Ð³Ð¾ ÑƒÑ‡Ñ‘Ñ‚Ð°
- ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼Ñ‹Ðµ Ð»Ð¸Ð¼Ð¸Ñ‚Ñ‹ Ð¿Ð¾ endpoint
- 429 Too Many Requests Ñ Retry-After

**Ð›Ð¸Ð¼Ð¸Ñ‚Ñ‹ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ:**
| Endpoint | Ð›Ð¸Ð¼Ð¸Ñ‚ | ÐžÐºÐ½Ð¾ |
|----------|-------|------|
| Playback | 60 | 1 min |
| Radio | 30 | 1 min |
| Recognition | 10 | 1 min |
| Lyrics | 20 | 1 min |

---

### 5. ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð½Ñ‹Ðµ Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ (P2)

**User Story**: VIP Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÑŽÑ‚ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ.

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:**
- Redis sorted sets Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð¾Ð²
- VIP Ñ‚Ñ€ÐµÐºÐ¸ Ð¿Ñ€Ð¾Ð¸Ð³Ñ€Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ñ€Ð°Ð½ÑŒÑˆÐµ
- Ð’Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ð°Ñ Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð°
- Admin override

**ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ñ‹:**
- `1000` - Admin
- `100` - VIP
- `10` - Regular
- `1` - Guest

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/queue          # ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ Ñ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð°Ð¼Ð¸
/vipqueue       # Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ VIP-Ñ‚Ñ€ÐµÐº (Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ñ€Ð¾Ð»Ð¸)
/priority 5     # Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ Ñ‚Ñ€ÐµÐºÐ°
```

---

### 6. Ð­ÐºÐ²Ð°Ð»Ð°Ð¹Ð·ÐµÑ€ (P2)

**User Story**: DJ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð¿Ñ€ÐµÐ´ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ ÑÐºÐ²Ð°Ð»Ð°Ð¹Ð·ÐµÑ€Ð°.

**ÐŸÑ€ÐµÑÐµÑ‚Ñ‹:**
| Preset | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|--------|----------|
| flat | ÐÐµÐ¹Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¹ |
| bass_boost | Ð£ÑÐ¸Ð»ÐµÐ½Ð¸Ðµ Ð±Ð°ÑÐ¾Ð² |
| treble_boost | Ð£ÑÐ¸Ð»ÐµÐ½Ð¸Ðµ Ð²Ñ‹ÑÐ¾ÐºÐ¸Ñ… |
| vocal | Ð’Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð²Ð¾ÐºÐ°Ð»Ð° |
| classical | ÐšÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ°Ñ Ð¼ÑƒÐ·Ñ‹ÐºÐ° |
| rock | Ð Ð¾Ðº |
| pop | ÐŸÐ¾Ð¿ |
| jazz | Ð”Ð¶Ð°Ð· |
| electronic | Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð¸ÐºÐ° |
| meditation | ÐœÐµÐ´Ð¸Ñ‚Ð°Ñ†Ð¸Ñ |
| relax | Ð Ð°ÑÑÐ»Ð°Ð±Ð»ÐµÐ½Ð¸Ðµ |

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/eq bassboost   # ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¿Ñ€ÐµÑÐµÑ‚
/eq             # ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹
/eqlist         # Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¿Ñ€ÐµÑÐµÑ‚Ð¾Ð²
```

**Web UI:**
- Ð’Ñ‹Ð±Ð¾Ñ€ Ð¿Ñ€ÐµÑÐµÑ‚Ð° Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ°
- 10-Ð¿Ð¾Ð»Ð¾ÑÐ½Ñ‹Ð¹ Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÐºÐ²Ð°Ð»Ð°Ð¹Ð·ÐµÑ€
- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ñ… Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº

---

### 7. ÐŸÐ»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ (P2)

**User Story**: ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð¿Ð»ÐµÐ¹Ð»Ð¸ÑÑ‚Ð¾Ð².

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:**
- Cron-Ð¿Ð¾Ð´Ð¾Ð±Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
- APScheduler Ð´Ð»Ñ Ð½Ð°Ð´Ñ‘Ð¶Ð½Ð¾ÑÑ‚Ð¸
- ÐŸÐµÑ€ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð½Ð¾ÑÑ‚ÑŒ Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ…
- ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€ Ð¿Ð¾ Ð´Ð½ÑÐ¼ Ð½ÐµÐ´ÐµÐ»Ð¸

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/schedule 08:00 morning_playlist    # Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾ Ð² 08:00
/schedule 18:00 evening mon,wed,fri # ÐŸÐ¾ Ð´Ð½ÑÐ¼
/schedules                          # Ð¡Ð¿Ð¸ÑÐ¾Ðº
/unschedule 1                       # Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ
```

**Web UI:**
- ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€Ð½Ñ‹Ð¹ Ð²Ð¸Ð´
- Drag-and-drop ÑÐ»Ð¾Ñ‚Ð¾Ð²
- Ð¨Ð°Ð±Ð»Ð¾Ð½Ñ‹ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ð¹

---

### 8. Ð¢ÐµÐºÑÑ‚Ñ‹ Ð¿ÐµÑÐµÐ½ (P2)

**User Story**: Ð¡Ð»ÑƒÑˆÐ°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ð¸Ð´ÐµÑ‚ÑŒ Ñ‚ÐµÐºÑÑ‚ Ð¿ÐµÑÐ½Ð¸.

**Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸:**
- Genius API (Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹)
- Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÐµÑˆ (7 Ð´Ð½ÐµÐ¹ TTL)

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/lyrics         # Ð¢ÐµÐºÑÑ‚ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ñ‚Ñ€ÐµÐºÐ°
/lyrics Artist - Song  # ÐŸÐ¾Ð¸ÑÐº
```

**Web UI:**
- ÐŸÐ°Ð½ÐµÐ»ÑŒ Ñ‚ÐµÐºÑÑ‚Ð° Ñ Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¾Ð¹
- ÐÐ²Ñ‚Ð¾ÑÐºÑ€Ð¾Ð»Ð» (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° ÑˆÑ€Ð¸Ñ„Ñ‚Ð°

---

### 9. Ð Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ðµ Ð¼ÑƒÐ·Ñ‹ÐºÐ¸ (P3)

**User Story**: ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð°ÑƒÐ´Ð¸Ð¾ Ð¸ ÑƒÐ·Ð½Ð°Ñ‚ÑŒ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑÐ½Ð¸.

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:**
- Shazam API Ñ‡ÐµÑ€ÐµÐ· shazamio
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
- Rate limit: 10 req/min

**Telegram:**
- ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð±Ð¾Ñ‚Ñƒ
- Ð‘Ð¾Ñ‚ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÐµÐ¼ Ñ‚Ñ€ÐµÐºÐ°

---

### 10. ÐœÑƒÐ»ÑŒÑ‚Ð¸-ÐºÐ°Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° (P3)

**User Story**: ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð¼Ð¾Ð¶ÐµÑ‚ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼Ð¸ ÐºÐ°Ð½Ð°Ð»Ð°Ð¼Ð¸ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾.

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:**
- Ð”Ð¾ 10 Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… ÐºÐ°Ð½Ð°Ð»Ð¾Ð²
- ÐÐµÐ·Ð°Ð²Ð¸ÑÐ¸Ð¼Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ (ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ, EQ)
- Redis-ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÑ‚Ð°Ñ‚ÑƒÑÐ¾Ð²
- Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/channels       # Ð¡Ð¿Ð¸ÑÐ¾Ðº ÐºÐ°Ð½Ð°Ð»Ð¾Ð²
/channel 123    # Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹
/channelinfo    # Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ ÐºÐ°Ð½Ð°Ð»Ðµ
/channelstatus  # Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð²ÑÐµÑ… ÐºÐ°Ð½Ð°Ð»Ð¾Ð²
```

**Web UI:**
- ÐŸÐ°Ð½ÐµÐ»ÑŒ Ð²Ñ‹Ð±Ð¾Ñ€Ð° ÐºÐ°Ð½Ð°Ð»Ð°
- Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°
- Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ

---

### 11. Ð›Ð¾ÐºÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ (P3)

**User Story**: Ð˜Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð½Ð° 4 ÑÐ·Ñ‹ÐºÐ°Ñ….

**Ð¯Ð·Ñ‹ÐºÐ¸:**
- ðŸ‡·ðŸ‡º Ð ÑƒÑÑÐºÐ¸Ð¹ (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ)
- ðŸ‡¬ðŸ‡§ English
- ðŸ‡ºðŸ‡¦ Ð£ÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ°
- ðŸ‡ªðŸ‡¸ EspaÃ±ol

**Telegram ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:**
```
/language       # Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÐ·Ñ‹Ðº
/language en    # Ð¡Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð° Ð°Ð½Ð³Ð»Ð¸Ð¹ÑÐºÐ¸Ð¹
```

**Web UI:**
- ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ Ð² header
- ÐÐ²Ñ‚Ð¾Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°
- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð² localStorage

---

## ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°

### Backend
```
backend/src/
â”œâ”€â”€ api/routes/
â”‚   â”œâ”€â”€ playback.py      # Speed, pitch, seek
â”‚   â”œâ”€â”€ radio.py         # Radio streams
â”‚   â”œâ”€â”€ lyrics.py        # Lyrics API
â”‚   â”œâ”€â”€ recognition.py   # Shazam
â”‚   â”œâ”€â”€ scheduler.py     # Schedules
â”‚   â””â”€â”€ i18n.py          # Languages
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ playback_service.py
â”‚   â”œâ”€â”€ radio_service.py
â”‚   â”œâ”€â”€ lyrics_service.py
â”‚   â”œâ”€â”€ shazam_service.py
â”‚   â”œâ”€â”€ scheduler_service.py
â”‚   â”œâ”€â”€ queue_service.py
â”‚   â”œâ”€â”€ channel_service.py
â”‚   â””â”€â”€ backup_service.py
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ playback_settings.py
â”‚   â”œâ”€â”€ radio_stream.py
â”‚   â”œâ”€â”€ lyrics_cache.py
â”‚   â””â”€â”€ scheduled_playlist.py
â””â”€â”€ telegram/commands/
    â”œâ”€â”€ playback.py
    â”œâ”€â”€ radio.py
    â”œâ”€â”€ lyrics.py
    â”œâ”€â”€ queue.py
    â”œâ”€â”€ equalizer.py
    â”œâ”€â”€ scheduler.py
    â””â”€â”€ channel.py
```

### Streamer
```
streamer/
â”œâ”€â”€ playback_control.py   # GStreamer control
â”œâ”€â”€ radio_handler.py      # HTTP streams
â”œâ”€â”€ queue_manager.py      # Redis queues
â”œâ”€â”€ audio_filters.py      # Equalizer
â””â”€â”€ multi_channel.py      # Channel management
```

### Frontend
```
frontend/src/
â”œâ”€â”€ components/player/
â”‚   â”œâ”€â”€ SpeedControl.tsx
â”‚   â”œâ”€â”€ SeekBar.tsx
â”‚   â”œâ”€â”€ EqualizerPanel.tsx
â”‚   â””â”€â”€ LyricsDisplay.tsx
â”œâ”€â”€ i18n/
â”‚   â”œâ”€â”€ index.ts
â”‚   â””â”€â”€ locales/
â”‚       â”œâ”€â”€ ru.json
â”‚       â”œâ”€â”€ en.json
â”‚       â”œâ”€â”€ uk.json
â”‚       â””â”€â”€ es.json
â””â”€â”€ components/common/
    â””â”€â”€ LanguageSwitcher.tsx
```

---

## Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ

### Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Backend
```
lyricsgenius>=3.0.0
shazamio>=0.4.0
APScheduler>=3.10.0
redis>=4.5.0
```

### Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Frontend
```
react-i18next>=13.0.0
i18next>=23.0.0
i18next-browser-languagedetector>=7.0.0
```

### GStreamer Ð¿Ð»Ð°Ð³Ð¸Ð½Ñ‹
- `scaletempo` - Ñ‚Ð°Ð¹Ð¼ÑÑ‚Ñ€ÐµÑ‚Ñ‡
- `equalizer-10bands` - ÑÐºÐ²Ð°Ð»Ð°Ð¹Ð·ÐµÑ€
- `souphttpsrc` - HTTP ÑÑ‚Ñ€Ð¸Ð¼Ñ‹

---

## ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ

### ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
```env
# Genius API
GENIUS_API_TOKEN=your_token_here

# Rate Limiting
RATE_LIMIT_PLAYBACK=60
RATE_LIMIT_RADIO=30
RATE_LIMIT_RECOGNITION=10

# Redis
REDIS_URL=redis://localhost:6379/0

# Multi-channel
MAX_CONCURRENT_CHANNELS=10
```

---

## Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### Unit Ñ‚ÐµÑÑ‚Ñ‹
```bash
pytest backend/tests/test_playback_service.py
pytest backend/tests/test_rate_limiter.py
pytest backend/tests/test_lyrics_service.py
```

### Integration Ñ‚ÐµÑÑ‚Ñ‹
```bash
pytest backend/tests/integration/
```

### E2E Ñ‚ÐµÑÑ‚Ñ‹
```bash
cd frontend && npm run test:e2e
```

---

## ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³

### ÐœÐµÑ‚Ñ€Ð¸ÐºÐ¸
- `playback_speed_changes_total` - Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸
- `seek_operations_total` - Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð¿ÐµÑ€ÐµÐ¼Ð¾Ñ‚ÐºÐ¸
- `radio_connections_active` - Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ñ€Ð°Ð´Ð¸Ð¾ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ
- `lyrics_cache_hits` - Ð¿Ð¾Ð¿Ð°Ð´Ð°Ð½Ð¸Ñ Ð² ÐºÐµÑˆ
- `recognition_requests_total` - Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ
- `rate_limit_exceeded_total` - Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¸Ñ Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð²

### ÐÐ»ÐµÑ€Ñ‚Ñ‹
- Radio stream disconnection > 5 min
- Rate limit exceeded > 100/hour
- Queue processing latency > 5s
