# –†–∞–±–æ—Ç–∞ —Å –ø–ª–µ–π–ª–∏—Å—Ç–∞–º–∏: –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ —à–∞—Ä–∏–Ω–≥

## 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º—É–∑—ã–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞ –≤ –ø–ª–µ–π–ª–∏—Å—Ç

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1. **–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** –≤ –ø–∞–ø–∫–µ `/music` (–∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ `MUSIC_ROOT` –≤ `.env`)

   –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
   ```
   /music/
   ‚îú‚îÄ‚îÄ Karunesh/
   ‚îÇ   ‚îú‚îÄ‚îÄ 2010-Heart-Chakra-Meditation/
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01-Opening-to-Softness.mp3
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 02-Breathing-Silence.mp3
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
   ‚îÇ   ‚îî‚îÄ‚îÄ 2015-Joy-of-Life/
   ‚îÇ       ‚îî‚îÄ‚îÄ ...
   ‚îî‚îÄ‚îÄ Various-Artists/
       ‚îî‚îÄ‚îÄ ...
   ```

2. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã**: mp3, mp4, m4a, flac, ogg, wav, opus, aac

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–∏

#### –ß–µ—Ä–µ–∑ UI:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É **–ü–ª–µ–π–ª–∏—Å—Ç—ã** (`/playlist`)
2. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ**: –Ω–∞–ø—Ä–∏–º–µ—Ä "Karunesh ALL"
   - **–û–ø–∏—Å–∞–Ω–∏–µ**: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
   - **–¶–≤–µ—Ç**: –≤—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –¥–ª—è –ø–ª–µ–π–ª–∏—Å—Ç–∞
   - **–ò—Å—Ç–æ—á–Ω–∏–∫**: –≤—ã–±–µ—Ä–∏—Ç–µ **"–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞"** (–∏–∫–æ–Ω–∫–∞ –∂—ë—Å—Ç–∫–æ–≥–æ –¥–∏—Å–∫–∞ üíø)
   - **–ü—É—Ç—å –∫ –ø–∞–ø–∫–µ**: —É–∫–∞–∂–∏—Ç–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –æ—Ç `MUSIC_ROOT`
     - –ü—Ä–∏–º–µ—Ä—ã: 
       - `Karunesh` ‚Äî –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ Karunesh (–Ω–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ)
       - `Karunesh/2010-Heart-Chakra-Meditation` ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞–ª—å–±–æ–º
       - `.` ‚Äî –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ MUSIC_ROOT
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ—Å–∫–∞–Ω–∏—Ä—É–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é –ø–∞–ø–∫—É
- –ò–∑–≤–ª–µ—á—ë—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –∞–ª—å–±–æ–º, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- –°–æ–∑–¥–∞—Å—Ç –ø–ª–µ–π–ª–∏—Å—Ç —Å —Ç—Ä–µ–∫–∞–º–∏

#### –ß–µ—Ä–µ–∑ API:

```bash
# 1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∞–ø–æ–∫
curl -H "Authorization: Bearer $TOKEN" \
  https://sattva-streamer.top/api/media/folders

# 2. –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É –∏ –ø–æ–ª—É—á–∏—Ç—å —Ñ–∞–π–ª—ã
curl -H "Authorization: Bearer $TOKEN" \
  "https://sattva-streamer.top/api/media/scan?folder=Karunesh&recursive=false"

# 3. –°–æ–∑–¥–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç
curl -X POST https://sattva-streamer.top/api/schedule/playlists \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "name": "Karunesh ALL",
    "source_type": "folder",
    "source_url": "Karunesh",
    "channel_id": "your-channel-id"
  }'
```

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| `/api/media/folders` | GET | –°–ø–∏—Å–æ–∫ –ø–∞–ø–æ–∫ —Å –º—É–∑—ã–∫–æ–π |
| `/api/media/folders/{path}/info` | GET | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–ø–∫–µ (–∫–æ–ª-–≤–æ —Ñ–∞–π–ª–æ–≤, —Ä–∞–∑–º–µ—Ä, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å) |
| `/api/media/folders/{path}/files` | GET | –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ |
| `/api/media/scan?folder={path}&recursive={bool}` | GET | –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–µ–π–ª–∏—Å—Ç–∞) |

## 2. –®–∞—Ä–∏–Ω–≥ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ —Å –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### –í–∞—Ä–∏–∞–Ω—Ç—ã —à–∞—Ä–∏–Ω–≥–∞

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—É–±–ª–∏—á–Ω—ã–π –ø–ª–µ–π–ª–∏—Å—Ç (–æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π)

**–§—É–Ω–∫—Ü–∏—è**: –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∏—Å—Ç–µ–º—ã –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–ª–µ–π–ª–∏—Å—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
2. –í–∫–ª—é—á–∏—Ç–µ –æ–ø—Ü–∏—é **"–ü—É–±–ª–∏—á–Ω—ã–π"** (–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –ü–ª–µ–π–ª–∏—Å—Ç –ø–æ—è–≤–∏—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ **"–ü—É–±–ª–∏—á–Ω—ã–µ –ø–ª–µ–π–ª–∏—Å—Ç—ã"** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**API:**
```bash
# –°–¥–µ–ª–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç –ø—É–±–ª–∏—á–Ω—ã–º
curl -X PUT https://sattva-streamer.top/api/schedule/playlists/{playlist_id} \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"is_public": true}'

# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤
curl https://sattva-streamer.top/api/schedule/playlists/public \
  -H "Authorization: Bearer $TOKEN"
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –®–∞—Ä–∏–Ω–≥ –ø–æ –∫–æ–¥—É (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø)

**–§—É–Ω–∫—Ü–∏—è**: –î–µ–ª–∏—Ç–µ—Å—å –ø–ª–µ–π–ª–∏—Å—Ç–æ–º —Ç–æ–ª—å–∫–æ —Å —Ç–µ–º–∏, –∫–æ–º—É –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –∫–æ–¥

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–ª–µ–π–ª–∏—Å—Ç
2. –ù–∞–∂–º–∏—Ç–µ **"–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"** ‚Üí **"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥"**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `abc123xyz789`)
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–¥ –¥—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
5. –ü–æ–ª—É—á–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∫–æ–¥ –≤ —Ä–∞–∑–¥–µ–ª–µ **"–ò–º–ø–æ—Ä—Ç –ø–ª–µ–π–ª–∏—Å—Ç–∞"**

**API:**
```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞
curl -X POST https://sattva-streamer.top/api/schedule/playlists/{playlist_id}/share \
  -H "Authorization: Bearer $TOKEN"

# –û—Ç–≤–µ—Ç: {"share_code": "abc123xyz789", "expires_at": "2025-12-18T..."}

# –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç –ø–æ –∫–æ–¥—É
curl -X POST https://sattva-streamer.top/api/schedule/playlists/import \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"share_code": "abc123xyz789"}'
```

### –°—Ö–µ–º–∞ –ë–î

–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—É `playlists`:

```sql
ALTER TABLE playlists 
  ADD COLUMN is_public BOOLEAN DEFAULT FALSE,
  ADD COLUMN share_code VARCHAR(32) UNIQUE;

CREATE INDEX idx_playlists_share_code ON playlists(share_code);
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ü—É–±–ª–∏—á–Ω—ã–µ –ø–ª–µ–π–ª–∏—Å—Ç—ã**: –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–∏—Å—Ç–µ–º—ã
- **–ö–æ–¥—ã —à–∞—Ä–∏–Ω–≥–∞**: 
  - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ 32-—Å–∏–º–≤–æ–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (UUID –±–µ–∑ –¥–µ—Ñ–∏—Å–æ–≤)
  - –ú–æ–∂–Ω–æ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å (—Å—Ç–∞—Ä—ã–π –∫–æ–¥ –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç —Ä–∞–±–æ—Ç–∞—Ç—å)
  - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –¥–æ–±–∞–≤–∏—Ç—å —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (expires_at)
- **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞**: —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –∫–æ–ø–∏—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è (–Ω–µ —Å—Å—ã–ª–∫–∞)

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç –∏–∑ –∞–ª—å–±–æ–º–∞ Karunesh

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞–ø–∫—É
curl -H "Authorization: Bearer $TOKEN" \
  "https://sattva-streamer.top/api/media/folders/Karunesh/2010-Heart-Chakra-Meditation/info"

# –û—Ç–≤–µ—Ç:
# {
#   "path": "Karunesh/2010-Heart-Chakra-Meditation",
#   "name": "2010-Heart-Chakra-Meditation",
#   "files_count": 12,
#   "total_size": 156789012,
#   "total_duration": 3245
# }

# 2. –°–æ–∑–¥–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç
curl -X POST https://sattva-streamer.top/api/schedule/playlists \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "name": "Heart Chakra Meditation",
    "description": "Karunesh - 2010",
    "source_type": "folder",
    "source_url": "Karunesh/2010-Heart-Chakra-Meditation",
    "color": "#14B8A6"
  }'
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø–ª–µ–π–ª–∏—Å—Ç–æ–º

```bash
# –ê–¥–º–∏–Ω –¥–µ–ª–∏—Ç—Å—è –ø–ª–µ–π–ª–∏—Å—Ç–æ–º —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º
PLAYLIST_ID="uuid-here"

# 1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
CODE=$(curl -X POST https://sattva-streamer.top/api/schedule/playlists/$PLAYLIST_ID/share \
  -H "Authorization: Bearer $ADMIN_TOKEN" | jq -r '.share_code')

echo "–ö–æ–¥ –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞: $CODE"

# 2. –û–ø–µ—Ä–∞—Ç–æ—Ä –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–ª–µ–π–ª–∏—Å—Ç
curl -X POST https://sattva-streamer.top/api/schedule/playlists/import \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $OPERATOR_TOKEN" \
  -d "{\"share_code\": \"$CODE\"}"
```

## TODO (–≤ –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö)

- [ ] –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ —Ç–∏–ø–∞ `folder` –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] Webhook –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –ø–ª–µ–π–ª–∏—Å—Ç–∞
- [ ] –†–µ–π—Ç–∏–Ω–≥ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø—É–±–ª–∏—á–Ω—ã–º –ø–ª–µ–π–ª–∏—Å—Ç–∞–º
- [ ] –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ (–∂–∞–Ω—Ä—ã, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –ø–ª–µ–π–ª–∏—Å—Ç–∞ –≤ m3u/json —Ñ–∞–π–ª
- [ ] –ò–º–ø–æ—Ä—Ç –ø–ª–µ–π–ª–∏—Å—Ç–∞ –∏–∑ Spotify/Apple Music
