# Руководство по теме фронтенда для Auth Flow

Документ описывает, как мы поддерживаем визуальную непрерывность лендинга на странице авторизации, включая адаптивный лэйаут и fallback-фон ZenScene. Все инструкции относятся к фиче `specs/008-auth-page-design` и компонентам в каталоге `frontend/src/components/auth/`.

## Содержание

1. [Responsive Auth Flow](#responsive-auth-flow)
2. [Fallback ZenScene и деградация WebGL](#fallback-zenscene-и-деградация-webgl)
3. [Порядок тестирования](#порядок-тестирования)
4. [Чек-лист при изменениях](#чек-лист-при-изменениях)

## Responsive Auth Flow

### Брейкпоинты и структура

- **base (≥320px)**: `AuthLayout` (`frontend/src/components/auth/AuthLayout.tsx`) рендерит секции последовательно — сначала hero, затем форма (`primary`), после этого блок превью (`secondary`). Основа — колонка с отступами `px-4` и вертикальным `gap-8`, что гарантирует отсутствие горизонтального скролла.
- **md (≥768px)**: grid переключается в две колонки `md:grid-cols-[minmax(0,1fr)_minmax(320px,420px)]`, где правая колонка фиксирует минимальную ширину формы (CTA всегда виден). Порядок секций меняется через `md:order-*`, поэтому на мобильных форма остаётся первой, а на планшетах prevью занимает левую колонку.
- **xl (≥1280px)**: ширина контейнера ограничена `max-w-screen-xl`, а колонки расширены до `xl:grid-cols-[minmax(0,0.85fr)_minmax(360px,480px)]`. Это оставляет дополнительные поля для стеклянных панелей и обеспечивает визуальный паритет с dashboard.

### Контент и доступность

- Типографика задаётся через CSS-переменные `--color-text`/`--color-text-muted` и шрифты LandingSans/Serif, подключённые в `frontend/src/main.tsx`.
- Дополнительные панели (например, статистика) размещаются в `secondary` и наследуют отступы `space-y-6`, чтобы не ломать вертикальный ритм на узких экранах.
- Любые новые CTA должны помещаться в `primary` и придерживаться `min-width: 320px`, иначе тесты Playwright (T017/T017a) зафиксируют переполнение.

## Fallback ZenScene и деградация WebGL

- Компонент `AuthZenScene` (`frontend/src/components/auth/ZenScene.tsx`) лениво подгружает ThreeJS сцену через `React.lazy` + `Suspense`. Пока Canvas не готов, форма авторизации полностью интерактивна (TTI < 2 c).
- Проверка WebGL (`checkWebGLAvailability`) выполняется на клиенте. Если поддержка отсутствует или к URL добавлен `?forceStatic=1`, компонент переключается на статический фон `frontend/public/fallback/zen-scene.svg`.
- Градиентный оверлей (`bg-gradient-to-b`) остаётся поверх и выравнивает контраст независимо от выбранной темы. Это покрывает edge cases EC-001/EC-002 из спецификации.
- Чтобы вручную проверить fallback, отключите аппаратное ускорение в браузере или добавьте параметр `forceStatic=1`. В обоих случаях `data-testid="auth-zen-fallback"` должен присутствовать в DOM.

## Порядок тестирования

1. `cd frontend && npx playwright test --grep responsive` — проверяет ширины 320/280 px, отсутствие overflow и работу CTA.
2. `npm run lighthouse:auth -- --preset=mobile` — гарантирует Lighthouse score > 90 и подтверждает, что ленивый Canvas не блокирует TTI.
3. `npm run test:unit -- --runTestsByPath src/components/auth/AuthLayout.tsx` (Vitest) — используем при добавлении новых секций, чтобы убедиться в корректном SSR/DOM дереве.
4. Логи из Playwright/Lighthouse складываем в `frontend/logs/` (см. `.gitignore`).

## Чек-лист при изменениях

- [ ] Сверить отступы и порядок секций с `data-model.md` (base/md/xl).
- [ ] Убедиться, что новые блоки не вводят горизонтальный скролл на 280 px.
- [ ] Проверить, что параметр `?forceStatic=1` всё ещё приводит к статическому SVG и не ломает тему.
- [ ] Обновить данный документ и `docs/auth-page-ui.md`, если меняются визуальные требования или набор токенов.
