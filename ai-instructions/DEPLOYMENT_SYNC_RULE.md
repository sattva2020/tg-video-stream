# –ü—Ä–∞–≤–∏–ª–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û–ï –ü–†–ê–í–ò–õ–û –î–õ–Ø AI-–ê–ì–ï–ù–¢–û–í

### –ü—Ä–∏–Ω—Ü–∏–ø: LOCAL-FIRST (–õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–µ—Ä–≤–∏—á–µ–Ω)

**–í–°–ï –∏–∑–º–µ–Ω–µ–Ω–∏—è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–Ω—ã —Å–Ω–∞—á–∞–ª–∞ –≤–Ω–æ—Å–∏—Ç—å—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –∞ –∑–∞—Ç–µ–º –¥–µ–ø–ª–æ–∏—Ç—å—Å—è –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.**

---

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π

### 1. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
```
1. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –õ–û–ö–ê–õ–¨–ù–û
2. git add + git commit + git push
3. SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä: git pull + build/restart
```

### 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (.env, config —Ñ–∞–π–ª—ã)
```
1. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –õ–û–ö–ê–õ–¨–ù–û (–∫–æ—Ä–Ω–µ–≤–æ–π .env, frontend/.env, backend/.env)
2. SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä: –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π .env —Ñ–∞–π–ª
3. –ï—Å–ª–∏ –Ω—É–∂–µ–Ω rebuild: git pull + npm run build
4. –ï—Å–ª–∏ –Ω—É–∂–µ–Ω restart: systemctl restart service
```

### 3. –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (emergency fix)
```
1. –°–¥–µ–ª–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. –ù–ï–ú–ï–î–õ–ï–ù–ù–û –≤–Ω–µ—Å—Ç–∏ —Ç–æ –∂–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–º–º–∏—Ç–µ: "sync: emergency fix from server"
```

---

## –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –∑–∞–¥–∞—á–∏

- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –µ—Å—Ç—å –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏?
- [ ] –í—Å–µ .env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ?
  - [ ] –ö–æ—Ä–Ω–µ–≤–æ–π `.env`
  - [ ] `frontend/.env` (VITE_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
  - [ ] `backend/.env` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –∏ –∑–∞–ø—É—à–µ–Ω—ã?
- [ ] –°–µ—Ä–≤–µ—Ä –æ–±–Ω–æ–≤–ª—ë–Ω —á–µ—Ä–µ–∑ git pull?

---

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ (–ù–ï –î–û–ü–£–°–ö–ê–¢–¨!)

‚ùå –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–æ–ª—å–∫–æ –≤ .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
‚ùå –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —á–µ—Ä–µ–∑ SSH
‚ùå –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚ùå –ó–∞–±—ã—Ç—å –ø—Ä–æ frontend/.env –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ VITE_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ .env —Ñ–∞–π–ª–æ–≤

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
|------|------------|------------------|
| `.env` | –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞ | Docker, backend, –æ–±—â–∏–µ |
| `frontend/.env` | Vite –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (VITE_*) | Frontend build |
| `backend/.env` | Backend-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ | Python/FastAPI |

### –ü—Ä–∞–≤–∏–ª–æ –¥–ª—è VITE –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
–ï—Å–ª–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è `VITE_*` –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:
1. –î–æ–±–∞–≤–∏—Ç—å –≤ `frontend/.env` –ª–æ–∫–∞–ª—å–Ω–æ
2. –î–æ–±–∞–≤–∏—Ç—å –≤ `/opt/sattva-streamer/frontend/.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. –í—ã–ø–æ–ª–Ω–∏—Ç—å `npm run build` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

## –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ workflow

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ TELEGRAM_BOT_ID:

```bash
# 1. –õ–û–ö–ê–õ–¨–ù–û: —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º .env
echo "TELEGRAM_BOT_ID=8431060192" >> .env

# 2. –õ–û–ö–ê–õ–¨–ù–û: —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º frontend/.env
echo "VITE_TELEGRAM_BOT_ID=8431060192" >> frontend/.env

# 3. –ö–æ–º–º–∏—Ç–∏–º (–µ—Å–ª–∏ .env –Ω–µ –≤ .gitignore)
# –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º –≤ README/docs

# 4. –ù–ê –°–ï–†–í–ï–†–ï: –¥–æ–±–∞–≤–ª—è–µ–º –≤ .env
ssh user@server "echo 'TELEGRAM_BOT_ID=8431060192' >> /opt/app/.env"
ssh user@server "echo 'VITE_TELEGRAM_BOT_ID=8431060192' >> /opt/app/frontend/.env"

# 5. –ù–ê –°–ï–†–í–ï–†–ï: rebuild –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
ssh user@server "cd /opt/app/frontend && npm run build"
```

---

## –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞
**30 –Ω–æ—è–±—Ä—è 2025**

## –ü—Ä–∏—á–∏–Ω–∞ —Å–æ–∑–¥–∞–Ω–∏—è
AI-–∞–≥–µ–Ω—Ç –¥–æ–±–∞–≤–∏–ª `VITE_TELEGRAM_BOT_ID` —Ç–æ–ª—å–∫–æ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, –Ω–µ –æ–±–Ω–æ–≤–∏–≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –≠—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º –ø—Ä–∏ –±—É–¥—É—â–∏—Ö –¥–µ–ø–ª–æ—è—Ö.

---

**–≠—Ç–æ –ø—Ä–∞–≤–∏–ª–æ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ –ö–ê–ñ–î–û–ú –∏–∑–º–µ–Ω–µ–Ω–∏–∏!**

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞ (Hybrid: Systemd + Docker)

### ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ü–æ—á–µ–º—É –ù–ï Docker –¥–ª—è Backend/Streamer

**–ü—Ä–∏—á–∏–Ω–∞**: YouTube –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è–µ—Ç API, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `yt-dlp`. 
–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Docker –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞, —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å.

**–†–µ—à–µ–Ω–∏–µ**: Backend –∏ Streamer —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ **systemd** –Ω–∞ —Ö–æ—Å—Ç–µ, –∞ –Ω–µ –≤ Docker.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

| –°–µ—Ä–≤–∏—Å | –ú–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ |
|--------|---------------|---------|
| **Backend (FastAPI)** | `systemd` | –¢—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è yt-dlp –Ω–∞ –ª–µ—Ç—É |
| **Streamer (PyTgCalls)** | `systemd` | –¢—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è yt-dlp –Ω–∞ –ª–µ—Ç—É |
| **Frontend (Nginx)** | `Docker` | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π |
| **PostgreSQL** | `Docker` | –°—Ç–∞–±–∏–ª—å–Ω—ã–π, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —á–∞—Å—Ç—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π |
| **Redis** | `Docker` | –°—Ç–∞–±–∏–ª—å–Ω—ã–π |
| **Prometheus/Grafana** | `Docker` | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π |

### –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ yt-dlp

```bash
# Cron –∑–∞–¥–∞—á–∞ (04:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ)
0 4 * * * /opt/sattva-streamer/backend/venv/bin/pip install -U yt-dlp && systemctl restart sattva-backend sattva-streamer
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx –¥–ª—è —Å–≤—è–∑–∏ —Å —Ö–æ—Å—Ç–æ–º

```nginx
# frontend/nginx.conf
location /api/ {
    # Backend –Ω–∞ —Ö–æ—Å—Ç–µ (systemd), –Ω–µ –≤ Docker!
    proxy_pass http://172.17.0.1:8000;
    ...
}
```

**172.17.0.1** ‚Äî IP –∞–¥—Ä–µ—Å docker0 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∫ —Ö–æ—Å—Ç—É.

### Systemd —Å–µ—Ä–≤–∏—Å—ã

–§–∞–π–ª—ã –≤ `/etc/systemd/system/`:
- `sattva-backend.service` ‚Äî FastAPI backend
- `sattva-streamer.service` ‚Äî PyTgCalls streamer

### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# Backend
systemctl status sattva-backend
systemctl restart sattva-backend
journalctl -u sattva-backend -f

# Streamer  
systemctl status sattva-streamer
systemctl restart sattva-streamer
journalctl -u sattva-streamer -f

# Frontend (Docker)
docker compose restart frontend
docker logs sattva-streamer-frontend-1
```

### ‚ùå –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ (–ù–ï –î–û–ü–£–°–ö–ê–¢–¨!)

- –ó–∞–ø—É—Å–∫–∞—Ç—å backend —á–µ—Ä–µ–∑ `docker compose up backend` ‚Äî –∫–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤ —Å systemd!
- –ó–∞–±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker backend –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è systemd —Å–µ—Ä–≤–∏—Å–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `proxy_pass http://backend:8000` ‚Äî Docker DNS –Ω–µ —Ä–µ–∑–æ–ª–≤–∏—Ç systemd —Å–µ—Ä–≤–∏—Å!

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ systemd —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç
systemctl status sattva-backend sattva-streamer

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker —Å–µ—Ä–≤–∏—Å—ã (–ë–ï–ó backend!)
docker compose up -d db redis frontend prometheus grafana alertmanager

# 3. –ù–ï –∑–∞–ø—É—Å–∫–∞—Ç—å docker backend!
# docker compose up -d backend  ‚Üê –ù–ï –î–ï–õ–ê–¢–¨!
```

---

**–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞**: 1 –¥–µ–∫–∞–±—Ä—è 2025  
**–ü—Ä–∏—á–∏–Ω–∞**: AI-–∞–≥–µ–Ω—Ç —Å–ª—É—á–∞–π–Ω–æ –≤–∫–ª—é—á–∏–ª Docker backend, —á—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É —Å systemd —Å–µ—Ä–≤–∏—Å–æ–º –Ω–∞ –ø–æ—Ä—Ç—É 8000.

