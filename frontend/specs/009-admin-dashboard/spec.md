# Feature Specification: Admin Dashboard

**Feature Branch**: `009-admin-dashboard`
**Created**: 2025-11-24
**Status**: Draft
**Input**: User description: "Implement full admin dashboard with user management and stream controls"

> ⚖️ Конституция: все текстовые блоки заполняем на русском. Каждая пользовательская история
> должна быть независимой, иметь измеримые критерии успеха и ссылаться на будущие тесты и
> документацию, иначе `/speckit.plan` не пройдет гейт.

## User Scenarios & Testing *(mandatory)*

### User Story 1 - Admin Dashboard Overview (Priority: P1)

Как администратор, я хочу иметь доступ к панели управления с обзором состояния системы, чтобы быстро оценивать ситуацию.

**Why this priority**: Обеспечивает единую точку входа для административных задач и мониторинга.

**Independent Test**: Авторизация под админом и проверка отображения вкладки "Overview" с карточками статистики.

**Acceptance Scenarios**:

1. **Given** я авторизован как `admin`, **When** я открываю Dashboard, **Then** я вижу панель администратора с вкладкой "Overview".
2. **Given** я на вкладке "Overview", **When** я смотрю на карточки, **Then** я вижу количество пользователей, количество ожидающих подтверждения и статус стрима.
3. **Given** я авторизован как `user`, **When** я открываю Dashboard, **Then** я НЕ вижу панель администратора, а вижу User Dashboard.

---

### User Story 2 - User Management (Priority: P1)

Как администратор, я хочу просматривать список пользователей и управлять их доступом (подтверждать/отклонять), чтобы контролировать регистрацию.

**Why this priority**: Критически важно для модерации доступа к закрытому сервису.

**Independent Test**: Создание нового пользователя (pending) и его одобрение через админку.

**Acceptance Scenarios**:

1. **Given** я на вкладке "Users", **When** я просматриваю список, **Then** я вижу таблицу с email и статусами пользователей.
2. **Given** в списке есть пользователь со статусом `pending`, **When** я нажимаю "Approve", **Then** статус пользователя меняется на `approved` и интерфейс обновляется.
3. **Given** в списке есть пользователь со статусом `pending`, **When** я нажимаю "Reject", **Then** статус пользователя меняется на `rejected`.

---

### User Story 3 - Stream Control (Priority: P1)

Как администратор, я хочу иметь возможность перезапустить стрим прямо из интерфейса, чтобы оперативно устранять неполадки вещания.

**Why this priority**: Позволяет восстанавливать работоспособность сервиса без доступа к консоли сервера.

**Independent Test**: Нажатие кнопки перезапуска и проверка вызова соответствующего API.

**Acceptance Scenarios**:

1. **Given** я на вкладке "Stream", **When** я нажимаю "Restart Stream" и подтверждаю действие, **Then** отправляется запрос на перезапуск и показывается уведомление об успехе.

---

### User Story 4 - User Dashboard (Priority: P2)

Как обычный пользователь, я хочу видеть информацию о своем профиле и статусе аккаунта.

**Why this priority**: Базовый интерфейс для пользователей, не являющихся администраторами.

**Independent Test**: Вход под обычным пользователем и проверка отображения профиля.

**Acceptance Scenarios**:

1. **Given** я авторизован как `user`, **When** я захожу в Dashboard, **Then** я вижу приветствие, свой email и статус аккаунта.
2. **Given** я авторизован как `user`, **When** я ищу элементы управления админа, **Then** я их не нахожу.

### Edge Cases

- **Ошибка API при действии**: Если сервер возвращает ошибку при одобрении пользователя или перезапуске стрима, должно показываться понятное уведомление (Toast/Alert).
- **Пустой список пользователей**: Таблица должна корректно отображать состояние "No users found".
- **Долгая загрузка**: При получении списка пользователей должен отображаться индикатор загрузки.

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: Система ДОЛЖНА предоставлять интерфейс `AdminDashboard` только пользователям с ролью `admin`.
- **FR-002**: Система ДОЛЖНА предоставлять интерфейс `UserDashboard` пользователям с ролью `user`.
- **FR-003**: Админ-панель ДОЛЖНА отображать статистику: общее число пользователей, число `pending` пользователей, статус стрима.
- **FR-004**: Админ-панель ДОЛЖНА позволять просматривать список всех пользователей с пагинацией или скроллом.
- **FR-005**: Админ-панель ДОЛЖНА позволять менять статус пользователя (`approve`/`reject`) без перезагрузки страницы.
- **FR-006**: Админ-панель ДОЛЖНА иметь функцию перезапуска стрима (`restart_stream`) с подтверждением действия.
- **FR-007**: Интерфейс ДОЛЖЕН поддерживать светлую и тёмную темы, используя системные настройки оформления.
- **FR-008**: Интерфейс ДОЛЖЕН быть адаптивным (Responsive) и корректно отображаться на мобильных устройствах.

### Key Entities *(include if feature involves data)*

- **User**: Используется для отображения списков и управления статусами (`id`, `email`, `status`, `role`).
- **StreamStatus**: (Виртуальная сущность) Состояние стрима (`Online`/`Offline`).

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: Администратор может одобрить нового пользователя менее чем за 3 клика после входа.
- **SC-002**: Время загрузки списка пользователей (до 100 записей) не превышает 1 секунду.
- **SC-003**: Обычный пользователь не имеет технической возможности выполнить действия администратора (безопасность на уровне системы).
- **SC-004**: Интерфейс корректно переключается между темами без артефактов.

## Future Work (Out of Scope for v1)

- **Мониторинг**: Графики битрейта и FPS (требует интеграции с ffmpeg).
- **Плейлист**: Управление списком воспроизведения (UI для добавления/удаления).
- **Логи**: Просмотр системных логов в интерфейсе.
