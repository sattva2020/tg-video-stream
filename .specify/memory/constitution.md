# tg-video-stream Constitution

## Core Principles

### I. Чистая структура
- Корень только для критически важных файлов; код и артефакты размещаются по каталогам (backend, frontend, streamer, specs, docs, scripts, config, tests).
- Временные/отладочные файлы — в `.internal/` или `_dev/`, добавлены в .gitignore.

### II. Документация и язык
- Все инструкции и спецификации в `docs/` и `ai-instructions/` ведутся на русском, формат Markdown.
- Перед коммитом документации запускать `npm run docs:validate`; после правок — `npm run docs:report` при необходимости.

### III. Test-first для изменений
- Новая логика сопровождается тестами в `backend/tests` или `frontend/tests`; smoke/пробы — в `tests/`.
- Для контрактов API добавлять тесты на схемы/валидаторы и happy/edge cases.

### IV. Конфиги и секреты
- Секреты (.env, .session) не коммитятся; используется template-based подход (`template.env` → `.env`).
- Любые изменения конфигураций на сервере синхронизируются в репозиторий (config/, шаблоны, docs).

### V. Простота и надёжность
- Предпочтение готовым библиотекам и минимальным зависимостям; избегаем преждевременной сложности.
- Наблюдаемость: журналирование ключевых операций, метрики для фич с SLA.

## Технологические стандарты
- Backend: Python 3.12, FastAPI, SQLAlchemy 2.x (async), Celery + Redis, PostgreSQL 15, httpx.
- Frontend: React 18 + Vite + TypeScript; Playwright/Vitest для тестов.
- Контейнеризация: Docker/Compose; CI/CD — GitHub Actions.

## Workflow и гейты
- Спецификации фич в `specs/<id>-<name>/`; планирование через `/speckit.plan`, задачи через `/speckit.tasks`.
- Перед слиянием: структура соблюдена, секреты вне git, тесты проходят, документация обновлена при затронутых требованиях.
- API/контракты документируются в `specs/.../contracts/` и проверяются тестами.

## Governance
- Конституция имеет приоритет над частными стилевыми предпочтениями. Любые отступления документируются и обосновываются в PR/plan (раздел Complexity Tracking).
- Обновления Конституции фиксируются в этом файле с указанием версии и даты; требуют явного одобрения ответственного по проекту.

**Version**: 1.0.0 | **Ratified**: 2025-12-10 | **Last Amended**: 2025-12-10
